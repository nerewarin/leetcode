"""
https://leetcode.com/problems/minimum-height-trees/description/?envType=problem-list-v2&envId=graph
"""

import collections

import pytest


class Solution:
    @staticmethod
    def _get_adj_list(n: int, edges: list[list[int]]) -> dict[int, list[int]]:
        adj_list: dict[int, list[int]] = {u: [] for u in range(n)}
        for u, v in edges:
            adj_list[u].append(v)
            adj_list[v].append(u)
        return adj_list

    @staticmethod
    def _get_leaves(in_degree: dict[int, int]):
        leaves: collections.deque[int] = collections.deque()
        for u, v in in_degree.items():
            if v == 1:
                leaves.append(u)
        return leaves

    def _leaf_peeling(self, adj_list: dict[int, list[int]]) -> list[int]:
        """
        Idea:
        You iteratively remove all leaves (degree = 1 nodes) layer by layer until ≤ 2 nodes remain.
        Those remaining nodes are the centers — i.e. roots of the minimum-height trees.

        Complexity: O(n)
        Data used: adjacency list + degree array + queue.

        """
        in_degree: dict[int, int] = {u: len(v) for u, v in adj_list.items()}
        assert all(v >= 1 for v in in_degree.values())

        leaves = self._get_leaves(in_degree)
        while len(in_degree) > 2:
            for i in range(len(leaves)):
                leaf = leaves.popleft()

                # peel
                in_degree.pop(leaf)
                neighbors = adj_list[leaf]
                for v in neighbors:
                    adj_list[v].remove(leaf)

                    in_degree[v] -= 1
                    if in_degree[v] == 1:
                        leaves.append(v)

                adj_list.pop(leaf)

        return list(in_degree)

    def findMinHeightTrees(self, n: int, edges: list[list[int]]) -> list[int]:
        if not edges:
            return list(range(n))
        adj_list = self._get_adj_list(n, edges)
        return self._leaf_peeling(adj_list)


def main(n: int, edges: list[list[int]]) -> list[int]:
    return Solution().findMinHeightTrees(n, edges)


@pytest.mark.parametrize(
    "input,expected",
    [
        pytest.param(
            dict(n=4, edges=[[1, 0], [1, 2], [1, 3]]),
            [1],
            id="""Input: n = 4, edges = [[1,0],[1,2],[1,3]]
            Output: [1]
            Explanation: As shown, the height of the tree is 1 when the root is the node with label 1 which is the only MHT.
                0
                1
            2       3
            """,
        ),
        pytest.param(
            dict(n=6, edges=[[3, 0], [3, 1], [3, 2], [3, 4], [5, 4]]),
            [3, 4],
            id="""Input: n = 6, edges = [[3,0],[3,1],[3,2],[3,4],[5,4]]
                Output: [3,4]
                   3
                0 1 2 4
                      5
            """,
        ),
        pytest.param(
            dict(n=6, edges=[[0, 1], [0, 2], [0, 3], [3, 4], [4, 5]]),
            [3],
            id="""Input: n = 6, edges =[[0,1],[0,2],[0,3],[3,4],[4,5]]
                Output: [3]
                0              1           2          3         4       5
            1   2   3          0           0        0    4    3   5     4
                    4       2    3       1   3    1  2   5    0         3
                    5            4           4              1 2 3       0
                                 5           5                         1 2
            """,
        ),
        pytest.param(
            dict(
                n=1818,
                edges=[
                    [0, 1],
                    [0, 2],
                    [1, 3],
                    [1, 4],
                    [2, 5],
                    [5, 6],
                    [0, 7],
                    [6, 8],
                    [8, 9],
                    [2, 10],
                    [2, 11],
                    [6, 12],
                    [2, 13],
                    [10, 14],
                    [1, 15],
                    [15, 16],
                    [9, 17],
                    [2, 18],
                    [2, 19],
                    [4, 20],
                    [13, 21],
                    [16, 22],
                    [5, 23],
                    [0, 24],
                    [8, 25],
                    [19, 26],
                    [3, 27],
                    [10, 28],
                    [12, 29],
                    [13, 30],
                    [4, 31],
                    [30, 32],
                    [20, 33],
                    [11, 34],
                    [17, 35],
                    [17, 36],
                    [0, 37],
                    [37, 38],
                    [6, 39],
                    [32, 40],
                    [16, 41],
                    [16, 42],
                    [41, 43],
                    [2, 44],
                    [9, 45],
                    [23, 46],
                    [25, 47],
                    [36, 48],
                    [11, 49],
                    [21, 50],
                    [30, 51],
                    [51, 52],
                    [7, 53],
                    [30, 54],
                    [47, 55],
                    [34, 56],
                    [31, 57],
                    [46, 58],
                    [1, 59],
                    [43, 60],
                    [23, 61],
                    [54, 62],
                    [62, 63],
                    [37, 64],
                    [1, 65],
                    [64, 66],
                    [11, 67],
                    [16, 68],
                    [25, 69],
                    [0, 70],
                    [21, 71],
                    [57, 72],
                    [49, 73],
                    [31, 74],
                    [61, 75],
                    [1, 76],
                    [26, 77],
                    [10, 78],
                    [16, 79],
                    [45, 80],
                    [57, 81],
                    [31, 82],
                    [29, 83],
                    [75, 84],
                    [49, 85],
                    [73, 86],
                    [39, 87],
                    [64, 88],
                    [65, 89],
                    [80, 90],
                    [12, 91],
                    [6, 92],
                    [65, 93],
                    [20, 94],
                    [5, 95],
                    [33, 96],
                    [3, 97],
                    [46, 98],
                    [53, 99],
                    [95, 100],
                    [65, 101],
                    [53, 102],
                    [61, 103],
                    [80, 104],
                    [0, 105],
                    [6, 106],
                    [88, 107],
                    [8, 108],
                    [38, 109],
                    [103, 110],
                    [55, 111],
                    [24, 112],
                    [104, 113],
                    [6, 114],
                    [105, 115],
                    [13, 116],
                    [38, 117],
                    [107, 118],
                    [46, 119],
                    [101, 120],
                    [5, 121],
                    [112, 122],
                    [48, 123],
                    [82, 124],
                    [40, 125],
                    [96, 126],
                    [35, 127],
                    [124, 128],
                    [22, 129],
                    [14, 130],
                    [82, 131],
                    [80, 132],
                    [127, 133],
                    [51, 134],
                    [86, 135],
                    [65, 136],
                    [121, 137],
                    [16, 138],
                    [73, 139],
                    [111, 140],
                    [91, 141],
                    [125, 142],
                    [72, 143],
                    [42, 144],
                    [128, 145],
                    [41, 146],
                    [146, 147],
                    [7, 148],
                    [20, 149],
                    [56, 150],
                    [46, 151],
                    [54, 152],
                    [126, 153],
                    [94, 154],
                    [129, 155],
                    [29, 156],
                    [82, 157],
                    [88, 158],
                    [76, 159],
                    [122, 160],
                    [59, 161],
                    [148, 162],
                    [100, 163],
                    [96, 164],
                    [53, 165],
                    [5, 166],
                    [2, 167],
                    [46, 168],
                    [48, 169],
                    [152, 170],
                    [59, 171],
                    [86, 172],
                    [170, 173],
                    [134, 174],
                    [114, 175],
                    [54, 176],
                    [11, 177],
                    [35, 178],
                    [113, 179],
                    [142, 180],
                    [148, 181],
                    [28, 182],
                    [147, 183],
                    [22, 184],
                    [151, 185],
                    [123, 186],
                    [26, 187],
                    [73, 188],
                    [55, 189],
                    [168, 190],
                    [8, 191],
                    [139, 192],
                    [81, 193],
                    [114, 194],
                    [2, 195],
                    [87, 196],
                    [14, 197],
                    [12, 198],
                    [94, 199],
                    [110, 200],
                    [118, 201],
                    [54, 202],
                    [77, 203],
                    [81, 204],
                    [46, 205],
                    [18, 206],
                    [167, 207],
                    [97, 208],
                    [23, 209],
                    [152, 210],
                    [150, 211],
                    [194, 212],
                    [57, 213],
                    [156, 214],
                    [2, 215],
                    [97, 216],
                    [172, 217],
                    [88, 218],
                    [47, 219],
                    [27, 220],
                    [126, 221],
                    [166, 222],
                    [201, 223],
                    [196, 224],
                    [8, 225],
                    [130, 226],
                    [49, 227],
                    [25, 228],
                    [42, 229],
                    [165, 230],
                    [53, 231],
                    [218, 232],
                    [224, 233],
                    [49, 234],
                    [15, 235],
                    [19, 236],
                    [24, 237],
                    [26, 238],
                    [97, 239],
                    [222, 240],
                    [61, 241],
                    [202, 242],
                    [39, 243],
                    [155, 244],
                    [123, 245],
                    [20, 246],
                    [25, 247],
                    [20, 248],
                    [106, 249],
                    [241, 250],
                    [197, 251],
                    [212, 252],
                    [245, 253],
                    [91, 254],
                    [206, 255],
                    [84, 256],
                    [69, 257],
                    [57, 258],
                    [246, 259],
                    [230, 260],
                    [194, 261],
                    [240, 262],
                    [54, 263],
                    [192, 264],
                    [89, 265],
                    [2, 266],
                    [201, 267],
                    [238, 268],
                    [225, 269],
                    [124, 270],
                    [247, 271],
                    [50, 272],
                    [181, 273],
                    [136, 274],
                    [92, 275],
                    [96, 276],
                    [272, 277],
                    [222, 278],
                    [75, 279],
                    [10, 280],
                    [65, 281],
                    [97, 282],
                    [148, 283],
                    [238, 284],
                    [238, 285],
                    [148, 286],
                    [134, 287],
                    [224, 288],
                    [253, 289],
                    [227, 290],
                    [126, 291],
                    [97, 292],
                    [131, 293],
                    [5, 294],
                    [5, 295],
                    [28, 296],
                    [295, 297],
                    [265, 298],
                    [8, 299],
                    [217, 300],
                    [98, 301],
                    [74, 302],
                    [201, 303],
                    [64, 304],
                    [179, 305],
                    [104, 306],
                    [100, 307],
                    [55, 308],
                    [103, 309],
                    [189, 310],
                    [268, 311],
                    [80, 312],
                    [97, 313],
                    [205, 314],
                    [67, 315],
                    [246, 316],
                    [79, 317],
                    [195, 318],
                    [229, 319],
                    [43, 320],
                    [109, 321],
                    [300, 322],
                    [291, 323],
                    [56, 324],
                    [156, 325],
                    [103, 326],
                    [146, 327],
                    [249, 328],
                    [252, 329],
                    [307, 330],
                    [193, 331],
                    [235, 332],
                    [255, 333],
                    [77, 334],
                    [217, 335],
                    [300, 336],
                    [114, 337],
                    [122, 338],
                    [112, 339],
                    [71, 340],
                    [321, 341],
                    [41, 342],
                    [21, 343],
                    [313, 344],
                    [173, 345],
                    [315, 346],
                    [122, 347],
                    [252, 348],
                    [190, 349],
                    [76, 350],
                    [106, 351],
                    [14, 352],
                    [8, 353],
                    [347, 354],
                    [330, 355],
                    [81, 356],
                    [29, 357],
                    [174, 358],
                    [33, 359],
                    [195, 360],
                    [236, 361],
                    [265, 362],
                    [61, 363],
                    [149, 364],
                    [140, 365],
                    [337, 366],
                    [218, 367],
                    [155, 368],
                    [247, 369],
                    [230, 370],
                    [213, 371],
                    [291, 372],
                    [176, 373],
                    [344, 374],
                    [294, 375],
                    [9, 376],
                    [174, 377],
                    [372, 378],
                    [356, 379],
                    [231, 380],
                    [225, 381],
                    [273, 382],
                    [196, 383],
                    [381, 384],
                    [105, 385],
                    [299, 386],
                    [104, 387],
                    [326, 388],
                    [145, 389],
                    [81, 390],
                    [150, 391],
                    [311, 392],
                    [123, 393],
                    [181, 394],
                    [71, 395],
                    [340, 396],
                    [31, 397],
                    [386, 398],
                    [39, 399],
                    [336, 400],
                    [197, 401],
                    [286, 402],
                    [87, 403],
                    [272, 404],
                    [2, 405],
                    [183, 406],
                    [253, 407],
                    [269, 408],
                    [367, 409],
                    [221, 410],
                    [181, 411],
                    [9, 412],
                    [364, 413],
                    [412, 414],
                    [89, 415],
                    [205, 416],
                    [312, 417],
                    [385, 418],
                    [414, 419],
                    [17, 420],
                    [347, 421],
                    [16, 422],
                    [369, 423],
                    [160, 424],
                    [358, 425],
                    [190, 426],
                    [370, 427],
                    [98, 428],
                    [103, 429],
                    [195, 430],
                    [94, 431],
                    [224, 432],
                    [208, 433],
                    [134, 434],
                    [56, 435],
                    [347, 436],
                    [268, 437],
                    [246, 438],
                    [36, 439],
                    [361, 440],
                    [130, 441],
                    [202, 442],
                    [429, 443],
                    [153, 444],
                    [410, 445],
                    [201, 446],
                    [295, 447],
                    [337, 448],
                    [325, 449],
                    [372, 450],
                    [339, 451],
                    [415, 452],
                    [411, 453],
                    [159, 454],
                    [267, 455],
                    [26, 456],
                    [405, 457],
                    [411, 458],
                    [395, 459],
                    [108, 460],
                    [27, 461],
                    [292, 462],
                    [153, 463],
                    [13, 464],
                    [155, 465],
                    [88, 466],
                    [321, 467],
                    [194, 468],
                    [401, 469],
                    [73, 470],
                    [338, 471],
                    [127, 472],
                    [322, 473],
                    [268, 474],
                    [105, 475],
                    [462, 476],
                    [60, 477],
                    [181, 478],
                    [156, 479],
                    [94, 480],
                    [321, 481],
                    [290, 482],
                    [306, 483],
                    [380, 484],
                    [172, 485],
                    [3, 486],
                    [316, 487],
                    [210, 488],
                    [170, 489],
                    [81, 490],
                    [326, 491],
                    [366, 492],
                    [369, 493],
                    [47, 494],
                    [199, 495],
                    [158, 496],
                    [139, 497],
                    [428, 498],
                    [422, 499],
                    [58, 500],
                    [205, 501],
                    [449, 502],
                    [307, 503],
                    [45, 504],
                    [128, 505],
                    [460, 506],
                    [293, 507],
                    [190, 508],
                    [45, 509],
                    [315, 510],
                    [84, 511],
                    [451, 512],
                    [179, 513],
                    [473, 514],
                    [474, 515],
                    [500, 516],
                    [138, 517],
                    [70, 518],
                    [289, 519],
                    [59, 520],
                    [7, 521],
                    [466, 522],
                    [82, 523],
                    [488, 524],
                    [175, 525],
                    [133, 526],
                    [291, 527],
                    [469, 528],
                    [369, 529],
                    [16, 530],
                    [500, 531],
                    [139, 532],
                    [228, 533],
                    [300, 534],
                    [411, 535],
                    [511, 536],
                    [104, 537],
                    [107, 538],
                    [424, 539],
                    [415, 540],
                    [410, 541],
                    [281, 542],
                    [136, 543],
                    [417, 544],
                    [265, 545],
                    [8, 546],
                    [388, 547],
                    [127, 548],
                    [379, 549],
                    [460, 550],
                    [405, 551],
                    [210, 552],
                    [347, 553],
                    [387, 554],
                    [545, 555],
                    [358, 556],
                    [481, 557],
                    [142, 558],
                    [85, 559],
                    [182, 560],
                    [438, 561],
                    [317, 562],
                    [1, 563],
                    [177, 564],
                    [49, 565],
                    [334, 566],
                    [247, 567],
                    [192, 568],
                    [436, 569],
                    [443, 570],
                    [404, 571],
                    [366, 572],
                    [208, 573],
                    [339, 574],
                    [203, 575],
                    [447, 576],
                    [496, 577],
                    [275, 578],
                    [376, 579],
                    [177, 580],
                    [292, 581],
                    [545, 582],
                    [424, 583],
                    [402, 584],
                    [169, 585],
                    [365, 586],
                    [366, 587],
                    [219, 588],
                    [2, 589],
                    [94, 590],
                    [190, 591],
                    [405, 592],
                    [172, 593],
                    [526, 594],
                    [280, 595],
                    [308, 596],
                    [134, 597],
                    [331, 598],
                    [246, 599],
                    [276, 600],
                    [538, 601],
                    [289, 602],
                    [485, 603],
                    [51, 604],
                    [240, 605],
                    [233, 606],
                    [491, 607],
                    [245, 608],
                    [447, 609],
                    [62, 610],
                    [432, 611],
                    [2, 612],
                    [10, 613],
                    [549, 614],
                    [503, 615],
                    [80, 616],
                    [12, 617],
                    [84, 618],
                    [161, 619],
                    [369, 620],
                    [387, 621],
                    [584, 622],
                    [529, 623],
                    [215, 624],
                    [566, 625],
                    [365, 626],
                    [246, 627],
                    [159, 628],
                    [537, 629],
                    [92, 630],
                    [470, 631],
                    [504, 632],
                    [225, 633],
                    [332, 634],
                    [603, 635],
                    [102, 636],
                    [411, 637],
                    [224, 638],
                    [245, 639],
                    [152, 640],
                    [254, 641],
                    [423, 642],
                    [441, 643],
                    [250, 644],
                    [527, 645],
                    [353, 646],
                    [53, 647],
                    [487, 648],
                    [3, 649],
                    [439, 650],
                    [158, 651],
                    [578, 652],
                    [204, 653],
                    [424, 654],
                    [620, 655],
                    [48, 656],
                    [313, 657],
                    [253, 658],
                    [52, 659],
                    [160, 660],
                    [511, 661],
                    [245, 662],
                    [395, 663],
                    [127, 664],
                    [131, 665],
                    [392, 666],
                    [322, 667],
                    [183, 668],
                    [73, 669],
                    [106, 670],
                    [436, 671],
                    [155, 672],
                    [334, 673],
                    [1, 674],
                    [195, 675],
                    [436, 676],
                    [256, 677],
                    [382, 678],
                    [117, 679],
                    [555, 680],
                    [541, 681],
                    [308, 682],
                    [162, 683],
                    [104, 684],
                    [343, 685],
                    [482, 686],
                    [105, 687],
                    [403, 688],
                    [672, 689],
                    [560, 690],
                    [116, 691],
                    [361, 692],
                    [91, 693],
                    [116, 694],
                    [175, 695],
                    [358, 696],
                    [161, 697],
                    [156, 698],
                    [107, 699],
                    [558, 700],
                    [400, 701],
                    [679, 702],
                    [268, 703],
                    [50, 704],
                    [292, 705],
                    [503, 706],
                    [175, 707],
                    [6, 708],
                    [43, 709],
                    [398, 710],
                    [212, 711],
                    [641, 712],
                    [618, 713],
                    [296, 714],
                    [498, 715],
                    [277, 716],
                    [356, 717],
                    [672, 718],
                    [31, 719],
                    [4, 720],
                    [66, 721],
                    [479, 722],
                    [211, 723],
                    [232, 724],
                    [318, 725],
                    [512, 726],
                    [463, 727],
                    [216, 728],
                    [364, 729],
                    [686, 730],
                    [707, 731],
                    [203, 732],
                    [467, 733],
                    [70, 734],
                    [26, 735],
                    [306, 736],
                    [440, 737],
                    [672, 738],
                    [398, 739],
                    [2, 740],
                    [318, 741],
                    [285, 742],
                    [87, 743],
                    [332, 744],
                    [397, 745],
                    [376, 746],
                    [305, 747],
                    [742, 748],
                    [712, 749],
                    [358, 750],
                    [126, 751],
                    [39, 752],
                    [696, 753],
                    [125, 754],
                    [526, 755],
                    [135, 756],
                    [352, 757],
                    [529, 758],
                    [684, 759],
                    [441, 760],
                    [267, 761],
                    [169, 762],
                    [260, 763],
                    [414, 764],
                    [233, 765],
                    [291, 766],
                    [697, 767],
                    [110, 768],
                    [159, 769],
                    [488, 770],
                    [51, 771],
                    [769, 772],
                    [293, 773],
                    [713, 774],
                    [498, 775],
                    [129, 776],
                    [367, 777],
                    [187, 778],
                    [306, 779],
                    [680, 780],
                    [169, 781],
                    [735, 782],
                    [155, 783],
                    [66, 784],
                    [267, 785],
                    [9, 786],
                    [236, 787],
                    [575, 788],
                    [725, 789],
                    [72, 790],
                    [261, 791],
                    [150, 792],
                    [529, 793],
                    [692, 794],
                    [110, 795],
                    [438, 796],
                    [467, 797],
                    [774, 798],
                    [577, 799],
                    [123, 800],
                    [355, 801],
                    [536, 802],
                    [797, 803],
                    [392, 804],
                    [2, 805],
                    [584, 806],
                    [96, 807],
                    [771, 808],
                    [624, 809],
                    [290, 810],
                    [86, 811],
                    [21, 812],
                    [29, 813],
                    [724, 814],
                    [389, 815],
                    [518, 816],
                    [77, 817],
                    [711, 818],
                    [677, 819],
                    [221, 820],
                    [334, 821],
                    [763, 822],
                    [37, 823],
                    [682, 824],
                    [191, 825],
                    [254, 826],
                    [784, 827],
                    [225, 828],
                    [1, 829],
                    [667, 830],
                    [304, 831],
                    [684, 832],
                    [15, 833],
                    [831, 834],
                    [808, 835],
                    [693, 836],
                    [818, 837],
                    [681, 838],
                    [831, 839],
                    [574, 840],
                    [571, 841],
                    [383, 842],
                    [481, 843],
                    [26, 844],
                    [572, 845],
                    [499, 846],
                    [718, 847],
                    [601, 848],
                    [208, 849],
                    [346, 850],
                    [621, 851],
                    [403, 852],
                    [651, 853],
                    [284, 854],
                    [562, 855],
                    [225, 856],
                    [297, 857],
                    [504, 858],
                    [543, 859],
                    [813, 860],
                    [646, 861],
                    [401, 862],
                    [834, 863],
                    [374, 864],
                    [859, 865],
                    [173, 866],
                    [435, 867],
                    [177, 868],
                    [363, 869],
                    [90, 870],
                    [253, 871],
                    [367, 872],
                    [109, 873],
                    [798, 874],
                    [565, 875],
                    [566, 876],
                    [105, 877],
                    [450, 878],
                    [814, 879],
                    [238, 880],
                    [182, 881],
                    [149, 882],
                    [125, 883],
                    [718, 884],
                    [99, 885],
                    [531, 886],
                    [417, 887],
                    [384, 888],
                    [376, 889],
                    [360, 890],
                    [865, 891],
                    [884, 892],
                    [347, 893],
                    [544, 894],
                    [390, 895],
                    [716, 896],
                    [728, 897],
                    [581, 898],
                    [133, 899],
                    [592, 900],
                    [821, 901],
                    [729, 902],
                    [512, 903],
                    [585, 904],
                    [349, 905],
                    [494, 906],
                    [450, 907],
                    [687, 908],
                    [260, 909],
                    [181, 910],
                    [519, 911],
                    [842, 912],
                    [202, 913],
                    [334, 914],
                    [450, 915],
                    [281, 916],
                    [663, 917],
                    [498, 918],
                    [46, 919],
                    [771, 920],
                    [29, 921],
                    [831, 922],
                    [349, 923],
                    [904, 924],
                    [751, 925],
                    [18, 926],
                    [26, 927],
                    [898, 928],
                    [920, 929],
                    [842, 930],
                    [501, 931],
                    [21, 932],
                    [324, 933],
                    [255, 934],
                    [43, 935],
                    [248, 936],
                    [355, 937],
                    [701, 938],
                    [791, 939],
                    [672, 940],
                    [235, 941],
                    [650, 942],
                    [408, 943],
                    [32, 944],
                    [422, 945],
                    [582, 946],
                    [97, 947],
                    [338, 948],
                    [803, 949],
                    [628, 950],
                    [612, 951],
                    [605, 952],
                    [422, 953],
                    [394, 954],
                    [121, 955],
                    [270, 956],
                    [549, 957],
                    [408, 958],
                    [537, 959],
                    [45, 960],
                    [446, 961],
                    [526, 962],
                    [644, 963],
                    [614, 964],
                    [581, 965],
                    [682, 966],
                    [499, 967],
                    [345, 968],
                    [2, 969],
                    [507, 970],
                    [40, 971],
                    [856, 972],
                    [927, 973],
                    [162, 974],
                    [309, 975],
                    [116, 976],
                    [402, 977],
                    [774, 978],
                    [938, 979],
                    [580, 980],
                    [807, 981],
                    [673, 982],
                    [597, 983],
                    [538, 984],
                    [205, 985],
                    [927, 986],
                    [653, 987],
                    [986, 988],
                    [757, 989],
                    [56, 990],
                    [307, 991],
                    [960, 992],
                    [203, 993],
                    [886, 994],
                    [661, 995],
                    [314, 996],
                    [644, 997],
                    [777, 998],
                    [604, 999],
                    [984, 1000],
                    [170, 1001],
                    [656, 1002],
                    [421, 1003],
                    [517, 1004],
                    [72, 1005],
                    [506, 1006],
                    [977, 1007],
                    [347, 1008],
                    [1008, 1009],
                    [724, 1010],
                    [583, 1011],
                    [766, 1012],
                    [313, 1013],
                    [860, 1014],
                    [824, 1015],
                    [478, 1016],
                    [285, 1017],
                    [550, 1018],
                    [853, 1019],
                    [24, 1020],
                    [450, 1021],
                    [143, 1022],
                    [735, 1023],
                    [589, 1024],
                    [16, 1025],
                    [969, 1026],
                    [473, 1027],
                    [552, 1028],
                    [774, 1029],
                    [922, 1030],
                    [78, 1031],
                    [416, 1032],
                    [453, 1033],
                    [879, 1034],
                    [537, 1035],
                    [485, 1036],
                    [335, 1037],
                    [570, 1038],
                    [216, 1039],
                    [744, 1040],
                    [741, 1041],
                    [989, 1042],
                    [365, 1043],
                    [934, 1044],
                    [317, 1045],
                    [457, 1046],
                    [127, 1047],
                    [174, 1048],
                    [717, 1049],
                    [270, 1050],
                    [786, 1051],
                    [4, 1052],
                    [191, 1053],
                    [869, 1054],
                    [1033, 1055],
                    [816, 1056],
                    [828, 1057],
                    [593, 1058],
                    [182, 1059],
                    [470, 1060],
                    [715, 1061],
                    [435, 1062],
                    [569, 1063],
                    [965, 1064],
                    [163, 1065],
                    [797, 1066],
                    [425, 1067],
                    [698, 1068],
                    [212, 1069],
                    [242, 1070],
                    [186, 1071],
                    [432, 1072],
                    [808, 1073],
                    [1018, 1074],
                    [968, 1075],
                    [266, 1076],
                    [721, 1077],
                    [600, 1078],
                    [938, 1079],
                    [990, 1080],
                    [478, 1081],
                    [999, 1082],
                    [971, 1083],
                    [45, 1084],
                    [260, 1085],
                    [130, 1086],
                    [109, 1087],
                    [820, 1088],
                    [1079, 1089],
                    [381, 1090],
                    [207, 1091],
                    [410, 1092],
                    [1050, 1093],
                    [712, 1094],
                    [609, 1095],
                    [459, 1096],
                    [413, 1097],
                    [327, 1098],
                    [462, 1099],
                    [494, 1100],
                    [484, 1101],
                    [1016, 1102],
                    [900, 1103],
                    [918, 1104],
                    [1102, 1105],
                    [1019, 1106],
                    [437, 1107],
                    [332, 1108],
                    [279, 1109],
                    [160, 1110],
                    [228, 1111],
                    [1097, 1112],
                    [379, 1113],
                    [231, 1114],
                    [870, 1115],
                    [797, 1116],
                    [541, 1117],
                    [936, 1118],
                    [843, 1119],
                    [561, 1120],
                    [792, 1121],
                    [486, 1122],
                    [711, 1123],
                    [145, 1124],
                    [1021, 1125],
                    [909, 1126],
                    [531, 1127],
                    [479, 1128],
                    [246, 1129],
                    [1037, 1130],
                    [338, 1131],
                    [514, 1132],
                    [557, 1133],
                    [422, 1134],
                    [436, 1135],
                    [975, 1136],
                    [289, 1137],
                    [83, 1138],
                    [247, 1139],
                    [342, 1140],
                    [154, 1141],
                    [781, 1142],
                    [41, 1143],
                    [987, 1144],
                    [1052, 1145],
                    [996, 1146],
                    [1093, 1147],
                    [687, 1148],
                    [80, 1149],
                    [747, 1150],
                    [303, 1151],
                    [1050, 1152],
                    [292, 1153],
                    [249, 1154],
                    [599, 1155],
                    [28, 1156],
                    [419, 1157],
                    [825, 1158],
                    [1149, 1159],
                    [205, 1160],
                    [163, 1161],
                    [712, 1162],
                    [873, 1163],
                    [882, 1164],
                    [729, 1165],
                    [775, 1166],
                    [420, 1167],
                    [94, 1168],
                    [708, 1169],
                    [133, 1170],
                    [413, 1171],
                    [853, 1172],
                    [989, 1173],
                    [985, 1174],
                    [538, 1175],
                    [704, 1176],
                    [1114, 1177],
                    [647, 1178],
                    [1071, 1179],
                    [454, 1180],
                    [575, 1181],
                    [762, 1182],
                    [357, 1183],
                    [420, 1184],
                    [129, 1185],
                    [766, 1186],
                    [131, 1187],
                    [65, 1188],
                    [599, 1189],
                    [341, 1190],
                    [1118, 1191],
                    [752, 1192],
                    [58, 1193],
                    [107, 1194],
                    [490, 1195],
                    [846, 1196],
                    [70, 1197],
                    [193, 1198],
                    [651, 1199],
                    [503, 1200],
                    [146, 1201],
                    [852, 1202],
                    [108, 1203],
                    [765, 1204],
                    [1007, 1205],
                    [896, 1206],
                    [781, 1207],
                    [53, 1208],
                    [357, 1209],
                    [467, 1210],
                    [311, 1211],
                    [235, 1212],
                    [511, 1213],
                    [1024, 1214],
                    [692, 1215],
                    [258, 1216],
                    [1118, 1217],
                    [855, 1218],
                    [538, 1219],
                    [1069, 1220],
                    [412, 1221],
                    [179, 1222],
                    [421, 1223],
                    [924, 1224],
                    [511, 1225],
                    [20, 1226],
                    [17, 1227],
                    [1046, 1228],
                    [234, 1229],
                    [952, 1230],
                    [1151, 1231],
                    [1119, 1232],
                    [748, 1233],
                    [266, 1234],
                    [275, 1235],
                    [722, 1236],
                    [166, 1237],
                    [905, 1238],
                    [542, 1239],
                    [1230, 1240],
                    [943, 1241],
                    [293, 1242],
                    [1087, 1243],
                    [43, 1244],
                    [123, 1245],
                    [1011, 1246],
                    [908, 1247],
                    [1224, 1248],
                    [64, 1249],
                    [220, 1250],
                    [691, 1251],
                    [1035, 1252],
                    [745, 1253],
                    [746, 1254],
                    [403, 1255],
                    [654, 1256],
                    [105, 1257],
                    [694, 1258],
                    [433, 1259],
                    [1013, 1260],
                    [189, 1261],
                    [63, 1262],
                    [86, 1263],
                    [777, 1264],
                    [24, 1265],
                    [626, 1266],
                    [608, 1267],
                    [1112, 1268],
                    [271, 1269],
                    [1074, 1270],
                    [214, 1271],
                    [374, 1272],
                    [691, 1273],
                    [763, 1274],
                    [4, 1275],
                    [1152, 1276],
                    [1077, 1277],
                    [1225, 1278],
                    [1087, 1279],
                    [1035, 1280],
                    [404, 1281],
                    [1118, 1282],
                    [648, 1283],
                    [353, 1284],
                    [204, 1285],
                    [1193, 1286],
                    [1204, 1287],
                    [1193, 1288],
                    [889, 1289],
                    [688, 1290],
                    [714, 1291],
                    [165, 1292],
                    [1256, 1293],
                    [854, 1294],
                    [861, 1295],
                    [1097, 1296],
                    [701, 1297],
                    [417, 1298],
                    [297, 1299],
                    [1254, 1300],
                    [647, 1301],
                    [499, 1302],
                    [94, 1303],
                    [185, 1304],
                    [155, 1305],
                    [620, 1306],
                    [610, 1307],
                    [455, 1308],
                    [206, 1309],
                    [2, 1310],
                    [1031, 1311],
                    [158, 1312],
                    [1223, 1313],
                    [951, 1314],
                    [82, 1315],
                    [914, 1316],
                    [1259, 1317],
                    [919, 1318],
                    [51, 1319],
                    [497, 1320],
                    [194, 1321],
                    [42, 1322],
                    [607, 1323],
                    [217, 1324],
                    [1072, 1325],
                    [717, 1326],
                    [104, 1327],
                    [548, 1328],
                    [1310, 1329],
                    [949, 1330],
                    [113, 1331],
                    [98, 1332],
                    [1042, 1333],
                    [1315, 1334],
                    [173, 1335],
                    [212, 1336],
                    [1081, 1337],
                    [1091, 1338],
                    [73, 1339],
                    [1036, 1340],
                    [458, 1341],
                    [960, 1342],
                    [1153, 1343],
                    [1174, 1344],
                    [451, 1345],
                    [435, 1346],
                    [910, 1347],
                    [834, 1348],
                    [985, 1349],
                    [738, 1350],
                    [999, 1351],
                    [1139, 1352],
                    [902, 1353],
                    [1333, 1354],
                    [1343, 1355],
                    [464, 1356],
                    [948, 1357],
                    [1355, 1358],
                    [1108, 1359],
                    [686, 1360],
                    [957, 1361],
                    [259, 1362],
                    [843, 1363],
                    [779, 1364],
                    [1217, 1365],
                    [1176, 1366],
                    [746, 1367],
                    [1210, 1368],
                    [903, 1369],
                    [800, 1370],
                    [113, 1371],
                    [1151, 1372],
                    [1267, 1373],
                    [1282, 1374],
                    [165, 1375],
                    [934, 1376],
                    [599, 1377],
                    [767, 1378],
                    [184, 1379],
                    [1148, 1380],
                    [310, 1381],
                    [824, 1382],
                    [989, 1383],
                    [1002, 1384],
                    [1297, 1385],
                    [340, 1386],
                    [200, 1387],
                    [583, 1388],
                    [146, 1389],
                    [1172, 1390],
                    [632, 1391],
                    [25, 1392],
                    [322, 1393],
                    [676, 1394],
                    [1048, 1395],
                    [1104, 1396],
                    [277, 1397],
                    [1138, 1398],
                    [430, 1399],
                    [615, 1400],
                    [776, 1401],
                    [196, 1402],
                    [524, 1403],
                    [440, 1404],
                    [1300, 1405],
                    [314, 1406],
                    [775, 1407],
                    [386, 1408],
                    [1190, 1409],
                    [1126, 1410],
                    [1255, 1411],
                    [481, 1412],
                    [497, 1413],
                    [221, 1414],
                    [1255, 1415],
                    [355, 1416],
                    [212, 1417],
                    [349, 1418],
                    [479, 1419],
                    [455, 1420],
                    [1324, 1421],
                    [1410, 1422],
                    [402, 1423],
                    [1083, 1424],
                    [1188, 1425],
                    [974, 1426],
                    [13, 1427],
                    [1166, 1428],
                    [1043, 1429],
                    [108, 1430],
                    [1328, 1431],
                    [936, 1432],
                    [384, 1433],
                    [812, 1434],
                    [881, 1435],
                    [778, 1436],
                    [343, 1437],
                    [579, 1438],
                    [1002, 1439],
                    [959, 1440],
                    [54, 1441],
                    [1379, 1442],
                    [586, 1443],
                    [878, 1444],
                    [861, 1445],
                    [1306, 1446],
                    [896, 1447],
                    [1193, 1448],
                    [207, 1449],
                    [931, 1450],
                    [963, 1451],
                    [1094, 1452],
                    [603, 1453],
                    [1194, 1454],
                    [1079, 1455],
                    [1144, 1456],
                    [410, 1457],
                    [588, 1458],
                    [291, 1459],
                    [1002, 1460],
                    [1025, 1461],
                    [84, 1462],
                    [19, 1463],
                    [608, 1464],
                    [101, 1465],
                    [815, 1466],
                    [1317, 1467],
                    [1359, 1468],
                    [1060, 1469],
                    [781, 1470],
                    [41, 1471],
                    [816, 1472],
                    [265, 1473],
                    [1445, 1474],
                    [1170, 1475],
                    [305, 1476],
                    [797, 1477],
                    [1442, 1478],
                    [1427, 1479],
                    [313, 1480],
                    [739, 1481],
                    [631, 1482],
                    [741, 1483],
                    [61, 1484],
                    [1242, 1485],
                    [1392, 1486],
                    [242, 1487],
                    [707, 1488],
                    [793, 1489],
                    [25, 1490],
                    [1084, 1491],
                    [594, 1492],
                    [646, 1493],
                    [958, 1494],
                    [799, 1495],
                    [892, 1496],
                    [868, 1497],
                    [123, 1498],
                    [1410, 1499],
                    [966, 1500],
                    [1480, 1501],
                    [960, 1502],
                    [540, 1503],
                    [1258, 1504],
                    [588, 1505],
                    [1290, 1506],
                    [372, 1507],
                    [1355, 1508],
                    [470, 1509],
                    [1306, 1510],
                    [585, 1511],
                    [181, 1512],
                    [282, 1513],
                    [1291, 1514],
                    [1243, 1515],
                    [752, 1516],
                    [1105, 1517],
                    [1228, 1518],
                    [381, 1519],
                    [160, 1520],
                    [1046, 1521],
                    [5, 1522],
                    [1188, 1523],
                    [615, 1524],
                    [695, 1525],
                    [895, 1526],
                    [5, 1527],
                    [599, 1528],
                    [725, 1529],
                    [758, 1530],
                    [9, 1531],
                    [1350, 1532],
                    [1219, 1533],
                    [972, 1534],
                    [169, 1535],
                    [1024, 1536],
                    [1317, 1537],
                    [608, 1538],
                    [1232, 1539],
                    [824, 1540],
                    [1480, 1541],
                    [1218, 1542],
                    [1102, 1543],
                    [92, 1544],
                    [229, 1545],
                    [564, 1546],
                    [905, 1547],
                    [1323, 1548],
                    [759, 1549],
                    [935, 1550],
                    [1264, 1551],
                    [1156, 1552],
                    [315, 1553],
                    [1545, 1554],
                    [1183, 1555],
                    [1349, 1556],
                    [1213, 1557],
                    [1525, 1558],
                    [510, 1559],
                    [750, 1560],
                    [1480, 1561],
                    [1446, 1562],
                    [1317, 1563],
                    [68, 1564],
                    [855, 1565],
                    [753, 1566],
                    [166, 1567],
                    [1383, 1568],
                    [458, 1569],
                    [1540, 1570],
                    [373, 1571],
                    [276, 1572],
                    [510, 1573],
                    [1225, 1574],
                    [207, 1575],
                    [623, 1576],
                    [1050, 1577],
                    [833, 1578],
                    [1540, 1579],
                    [1138, 1580],
                    [767, 1581],
                    [409, 1582],
                    [643, 1583],
                    [450, 1584],
                    [221, 1585],
                    [1258, 1586],
                    [643, 1587],
                    [1456, 1588],
                    [1100, 1589],
                    [1454, 1590],
                    [545, 1591],
                    [1396, 1592],
                    [1424, 1593],
                    [954, 1594],
                    [12, 1595],
                    [977, 1596],
                    [1336, 1597],
                    [1058, 1598],
                    [1276, 1599],
                    [1426, 1600],
                    [29, 1601],
                    [847, 1602],
                    [895, 1603],
                    [1487, 1604],
                    [1471, 1605],
                    [428, 1606],
                    [1198, 1607],
                    [293, 1608],
                    [1316, 1609],
                    [783, 1610],
                    [538, 1611],
                    [364, 1612],
                    [1461, 1613],
                    [1044, 1614],
                    [313, 1615],
                    [1055, 1616],
                    [1530, 1617],
                    [1248, 1618],
                    [768, 1619],
                    [1020, 1620],
                    [55, 1621],
                    [262, 1622],
                    [126, 1623],
                    [1221, 1624],
                    [1299, 1625],
                    [1574, 1626],
                    [983, 1627],
                    [1563, 1628],
                    [433, 1629],
                    [720, 1630],
                    [175, 1631],
                    [885, 1632],
                    [178, 1633],
                    [316, 1634],
                    [660, 1635],
                    [309, 1636],
                    [987, 1637],
                    [1445, 1638],
                    [588, 1639],
                    [1615, 1640],
                    [902, 1641],
                    [798, 1642],
                    [243, 1643],
                    [351, 1644],
                    [625, 1645],
                    [135, 1646],
                    [363, 1647],
                    [1310, 1648],
                    [649, 1649],
                    [898, 1650],
                    [1174, 1651],
                    [248, 1652],
                    [374, 1653],
                    [1408, 1654],
                    [1279, 1655],
                    [1558, 1656],
                    [251, 1657],
                    [284, 1658],
                    [1266, 1659],
                    [1479, 1660],
                    [798, 1661],
                    [969, 1662],
                    [50, 1663],
                    [773, 1664],
                    [440, 1665],
                    [280, 1666],
                    [923, 1667],
                    [1525, 1668],
                    [962, 1669],
                    [1062, 1670],
                    [1604, 1671],
                    [1291, 1672],
                    [865, 1673],
                    [1191, 1674],
                    [763, 1675],
                    [413, 1676],
                    [826, 1677],
                    [384, 1678],
                    [825, 1679],
                    [115, 1680],
                    [485, 1681],
                    [809, 1682],
                    [1244, 1683],
                    [822, 1684],
                    [755, 1685],
                    [863, 1686],
                    [193, 1687],
                    [914, 1688],
                    [351, 1689],
                    [919, 1690],
                    [1256, 1691],
                    [1129, 1692],
                    [1284, 1693],
                    [1113, 1694],
                    [1032, 1695],
                    [437, 1696],
                    [102, 1697],
                    [207, 1698],
                    [107, 1699],
                    [545, 1700],
                    [1442, 1701],
                    [1107, 1702],
                    [832, 1703],
                    [292, 1704],
                    [133, 1705],
                    [33, 1706],
                    [124, 1707],
                    [796, 1708],
                    [417, 1709],
                    [597, 1710],
                    [509, 1711],
                    [99, 1712],
                    [142, 1713],
                    [1094, 1714],
                    [1617, 1715],
                    [157, 1716],
                    [539, 1717],
                    [302, 1718],
                    [1127, 1719],
                    [149, 1720],
                    [432, 1721],
                    [4, 1722],
                    [484, 1723],
                    [149, 1724],
                    [1200, 1725],
                    [610, 1726],
                    [1017, 1727],
                    [1209, 1728],
                    [497, 1729],
                    [402, 1730],
                    [466, 1731],
                    [315, 1732],
                    [1529, 1733],
                    [416, 1734],
                    [215, 1735],
                    [279, 1736],
                    [1684, 1737],
                    [1520, 1738],
                    [916, 1739],
                    [986, 1740],
                    [1700, 1741],
                    [1574, 1742],
                    [792, 1743],
                    [241, 1744],
                    [1630, 1745],
                    [463, 1746],
                    [1645, 1747],
                    [888, 1748],
                    [1020, 1749],
                    [1523, 1750],
                    [1192, 1751],
                    [1668, 1752],
                    [348, 1753],
                    [670, 1754],
                    [464, 1755],
                    [382, 1756],
                    [1659, 1757],
                    [1734, 1758],
                    [1114, 1759],
                    [1094, 1760],
                    [566, 1761],
                    [242, 1762],
                    [1703, 1763],
                    [485, 1764],
                    [199, 1765],
                    [1412, 1766],
                    [662, 1767],
                    [975, 1768],
                    [1052, 1769],
                    [653, 1770],
                    [817, 1771],
                    [1620, 1772],
                    [1754, 1773],
                    [1109, 1774],
                    [1327, 1775],
                    [786, 1776],
                    [1709, 1777],
                    [329, 1778],
                    [980, 1779],
                    [1144, 1780],
                    [1386, 1781],
                    [116, 1782],
                    [199, 1783],
                    [227, 1784],
                    [1133, 1785],
                    [1303, 1786],
                    [111, 1787],
                    [1750, 1788],
                    [618, 1789],
                    [1246, 1790],
                    [515, 1791],
                    [1295, 1792],
                    [1751, 1793],
                    [775, 1794],
                    [1387, 1795],
                    [25, 1796],
                    [1211, 1797],
                    [19, 1798],
                    [1071, 1799],
                    [121, 1800],
                    [1578, 1801],
                    [1409, 1802],
                    [802, 1803],
                    [186, 1804],
                    [1721, 1805],
                    [969, 1806],
                    [1227, 1807],
                    [1641, 1808],
                    [769, 1809],
                    [349, 1810],
                    [292, 1811],
                    [158, 1812],
                    [1768, 1813],
                    [1251, 1814],
                    [637, 1815],
                    [356, 1816],
                    [973, 1817],
                ],
            ),
            [2, 5],
            id="""Time Limit Exceeded :)
            """,
        ),
        pytest.param(
            dict(n=1, edges=[]),
            [],
            id="""Empty""",
        ),
    ],
)
def test(input, expected):
    assert main(**input) == expected
